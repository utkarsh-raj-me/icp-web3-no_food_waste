(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{6928:function(e,t,s){Promise.resolve().then(s.bind(s,1559))},1559:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),r=s(6110),n=s(3644),i=s(3015),l=s(3715),c=s(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,c.Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),d=(0,c.Z)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var u=s(9314);let x=e=>(Number(e)/1e8).toFixed(2),h=e=>(0,u.ZP)(Number(e)/1e6,"PPP"),m=e=>Number(e).toString();function g(){let{userStats:e,transactions:t,userListings:s,isLoading:c}=(0,n.useApp)(),{principal:u}=(0,i.useAuthContext)();return c?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,a.jsx)(l.Z,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Your Profile"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{className:"text-lg",children:"Total Listings"})}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("p",{className:"text-3xl font-bold",children:(null==e?void 0:e.totalListings.toString())||"0"})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{className:"text-lg",children:"Active Listings"})}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("p",{className:"text-3xl font-bold",children:(null==e?void 0:e.activeListings.toString())||"0"})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{className:"text-lg",children:"Total Purchases"})}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("p",{className:"text-3xl font-bold",children:(null==e?void 0:e.totalPurchases.toString())||"0"})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{className:"text-lg",children:"Success Rate"})}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("p",{className:"text-3xl font-bold",children:e&&e.totalListings>BigInt(0)?"".concat(Math.round(Number(e.activeListings)/Number(e.totalListings)*100),"%"):"0%"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:"Recent Transactions"})}),(0,a.jsx)(r.aY,{children:0===t.length?(0,a.jsx)("p",{className:"text-gray-500",children:"No transactions yet"}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-2 rounded-full ".concat("completed"in e.status?"bg-green-100":"pending"in e.status?"bg-yellow-100":"bg-red-100"),children:"completed"in e.status?(0,a.jsx)(o,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(d,{className:"h-5 w-5 text-yellow-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"completed"in e.status?"Purchase":"Sale"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:h(e.createdAt)})]})]}),(0,a.jsxs)("p",{className:"font-semibold ".concat("completed"in e.status?"text-green-600":"pending"in e.status?"text-yellow-600":"text-red-600"),children:[x(e.price)," ICP"]})]},e.id))})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:"Your Listings"})}),(0,a.jsx)(r.aY,{children:0===s.length?(0,a.jsx)("p",{className:"text-gray-500",children:"No listings yet"}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:h(e.createdAt)})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold",children:[x(e.price)," ICP"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Quantity: ",m(e.quantity)]})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:e.description}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Expires: ",h(e.expiryDate)]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["â€¢ ",e.category]})]})]},e.id))})})]})]})]})}},6110:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var a=s(7437),r=s(2265),n=s(9311);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},3644:function(e,t,s){"use strict";s.r(t),s.d(t,{AppProvider:function(){return c},useApp:function(){return o}});var a=s(7437),r=s(2265),n=s(3015),i=s(4430);let l=(0,r.createContext)(void 0);function c(e){let{children:t}=e,{principal:s,isAuthenticated:c}=(0,n.useAuthContext)(),[o,d]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[g,p]=(0,r.useState)(null),[f,N]=(0,r.useState)(!0),j=async()=>{try{let e=await i.t.getActor(),t=await e.getActiveListings();"ok"in t&&d(t.ok)}catch(e){console.error("Failed to fetch listings:",e)}},y=async()=>{if(s)try{let e=await i.t.getActor(),[t,a,r]=await Promise.all([e.getListingsByUser(s),e.getUserPurchases(),e.getStats()]);"ok"in t&&x(t.ok),"ok"in a&&m(a.ok),"ok"in r&&p(r.ok)}catch(e){console.error("Failed to fetch user data:",e)}};return(0,r.useEffect)(()=>{let e=async()=>{N(!0);try{await Promise.all([j(),y()])}finally{N(!1)}};c&&s?e():N(!1)},[c,s]),(0,a.jsx)(l.Provider,{value:{listings:o,userListings:u,transactions:h,userStats:g,isLoading:f,refreshListings:j,refreshUserData:y},children:t})}function o(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useApp must be used within an AppProvider");return e}},3015:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return l},useAuthContext:function(){return c}});var a=s(7437),r=s(2265),n=s(7262);let i=(0,r.createContext)(void 0);function l(e){let{children:t}=e,s=(0,n.a)();return(0,a.jsx)(i.Provider,{value:s,children:t})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},7262:function(e,t,s){"use strict";s.d(t,{a:function(){return n}});var a=s(2265),r=s(1928);function n(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await r.LY.create(),s=await e.isAuthenticated();if(t(s),s){let t=e.getIdentity();n(t.getPrincipal())}}catch(e){console.error("Auth initialization failed:",e)}finally{l(!1)}},o=async()=>{let e=await r.LY.create(),s=BigInt(1),a=BigInt(24),i=BigInt(36e11);e.login({identityProvider:"http://bkyz2-fmaaa-aaaaa-qaaaq-cai.localhost:8000",maxTimeToLive:s*a*i,onSuccess:()=>{t(!0);let s=e.getIdentity();n(s.getPrincipal())}})},d=async()=>{let e=await r.LY.create();await e.logout(),t(!1),n(null)};return{isAuthenticated:e,principal:(null==s?void 0:s.toString())||null,isLoading:i,login:o,logout:d}}},4430:function(e,t,s){"use strict";s.d(t,{t:function(){return i}});var a=s(1794),r=s(1928);let n=e=>{let{IDL:t}=e,s=t.Vec(t.Nat8),a=t.Record({e8s:t.Nat64}),r=t.Nat64,n=t.Vec(t.Nat8),i=t.Record({timestamp_nanos:t.Nat64});t.Record({to:s,fee:a,memo:r,from_subaccount:t.Opt(n),created_at_time:t.Opt(i),amount:a});let l=t.Nat64,c=t.Record({duration_nanos:t.Nat64}),o=t.Variant({TxTooOld:t.Record({allowed_window_nanos:c}),BadFee:t.Record({expected_fee:a}),TxDuplicate:t.Record({duplicate_of:l}),TxCreatedInFuture:t.Null,InsufficientFunds:t.Record({balance:a})});t.Variant({Ok:l,Err:o});let d=t.Variant({ok:t.Text,err:t.Text}),u=t.Variant({Sold:t.Null,Active:t.Null,Cancelled:t.Null,Expired:t.Null}),x=t.Record({id:t.Text,status:u,title:t.Text,expiresAt:t.Int,createdAt:t.Int,description:t.Text,seller:t.Principal,price:t.Nat64,images:t.Vec(t.Text)}),h=t.Variant({Failed:t.Null,Refunded:t.Null,Completed:t.Null,Pending:t.Null}),m=t.Record({id:t.Text,status:h,listingId:t.Text,createdAt:t.Int,buyer:t.Principal,price:t.Nat64}),g=t.Record({totalVolume:t.Nat64,totalListings:t.Nat,completedPurchases:t.Nat,activePurchases:t.Nat}),p=t.Variant({ok:t.Null,err:t.Text}),f=t.Service({createListing:t.Func([t.Text,t.Text,t.Nat64,t.Vec(t.Text),t.Int],[d],[]),createPurchase:t.Func([t.Text],[d],[]),getActiveListings:t.Func([],[t.Vec(x)],["query"]),getExpiredListings:t.Func([],[t.Vec(x)],["query"]),getListing:t.Func([t.Text],[t.Opt(x)],["query"]),getListings:t.Func([t.Opt(u),t.Opt(t.Nat64)],[t.Vec(x)],["query"]),getListingsByUser:t.Func([t.Principal],[t.Vec(x)],["query"]),getPurchase:t.Func([t.Text],[t.Opt(m)],["query"]),getStats:t.Func([],[g],["query"]),updateListing:t.Func([t.Text,t.Opt(t.Text),t.Opt(t.Text),t.Opt(t.Nat64),t.Opt(u)],[p],[])});return f},i=new class{async getActor(){if(this.actor)return this.actor;try{let e=await r.LY.create(),t=e.getIdentity(),s=new a.i7({identity:t,host:"http://localhost:8000"});return this.actor=a.vt.createActor(n,{agent:s,canisterId:"be2us-64aaa-aaaaa-qaabq-cai"}),this.actor}catch(e){throw console.error("Failed to create actor:",e),e}}constructor(){this.actor=null}}},9311:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(7042),r=s(4769);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[395,258,314,971,864,744],function(){return e(e.s=6928)}),_N_E=e.O()}]);