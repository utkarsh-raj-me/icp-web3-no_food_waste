(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8876:function(e,t,r){Promise.resolve().then(r.t.bind(r,8877,23)),Promise.resolve().then(r.bind(r,1767)),Promise.resolve().then(r.bind(r,7757)),Promise.resolve().then(r.bind(r,9780)),Promise.resolve().then(r.bind(r,3644)),Promise.resolve().then(r.bind(r,3015)),Promise.resolve().then(r.t.bind(r,3247,23))},1767:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),n=r(1396),s=r.n(n),i=r(4033),o=r(3023),c=r(3015),u=r(3715);function l(){let e=(0,i.usePathname)(),{isAuthenticated:t,isLoading:r,login:n,logout:l}=(0,c.useAuthContext)();return(0,a.jsx)("nav",{className:"bg-white shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(s(),{href:"/",className:"flex items-center",children:(0,a.jsx)("span",{className:"text-xl font-bold text-green-600",children:"FoodWaste"})}),(0,a.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:["/listings"!==e&&(0,a.jsx)(s(),{href:"/listings",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Browse Listings"}),t&&(0,a.jsxs)(a.Fragment,{children:["/create-listing"!==e&&(0,a.jsx)(s(),{href:"/create-listing",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Create Listing"}),"/profile"!==e&&(0,a.jsx)(s(),{href:"/profile",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Profile"})]})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:r?(0,a.jsx)(u.Z,{className:"h-5 w-5 animate-spin text-gray-500"}):t?(0,a.jsx)(o.z,{variant:"outline",onClick:l,className:"ml-4 text-gray-500",children:"Logout"}):(0,a.jsx)(o.z,{onClick:n,className:"ml-4 bg-green-600 text-white hover:bg-green-700",children:"Login"})})]})})})}},7757:function(e,t,r){"use strict";r.r(t),r.d(t,{RouteGuard:function(){return u}});var a=r(7437),n=r(2265),s=r(4033),i=r(7262);let o=["/profile","/create-listing"],c=["/login"];function u(e){let{children:t}=e,{isAuthenticated:r,isLoading:u}=(0,i.a)(),l=(0,s.usePathname)(),d=(0,s.useRouter)();return((0,n.useEffect)(()=>{!u&&(!r&&o.includes(l)?d.push("/"):r&&c.includes(l)&&d.push("/"))},[r,u,l,d]),u)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"})}):(0,a.jsx)(a.Fragment,{children:t})}},3023:function(e,t,r){"use strict";r.d(t,{d:function(){return c},z:function(){return u}});var a=r(7437),n=r(2265),s=r(7256),i=r(9213),o=r(9311);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:u=!1,...l}=e,d=u?s.g7:"button";return(0,a.jsx)(d,{className:(0,o.cn)(c({variant:n,size:i,className:r})),ref:t,...l})});u.displayName="Button"},9780:function(e,t,r){"use strict";r.r(t),r.d(t,{Toaster:function(){return A}});var a=r(7437),n=r(2265);let s=0,i=new Map,o=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},u=[],l={toasts:[]};function d(e){l=c(l,e),u.forEach(e=>{e(l)})}function f(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}var p=r(8361),x=r(9213),m=r(2549),g=r(9311);let h=p.zt,v=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(p.l_,{ref:t,className:(0,g.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...n})});v.displayName=p.l_.displayName;let y=(0,x.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),b=n.forwardRef((e,t)=>{let{className:r,variant:n,...s}=e;return(0,a.jsx)(p.fC,{ref:t,className:(0,g.cn)(y({variant:n}),r),...s})});b.displayName=p.fC.displayName;let N=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(p.aU,{ref:t,className:(0,g.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...n})});N.displayName=p.aU.displayName;let w=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(p.x8,{ref:t,className:(0,g.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...n,children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})});w.displayName=p.x8.displayName;let T=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(p.Dx,{ref:t,className:(0,g.cn)("text-sm font-semibold",r),...n})});T.displayName=p.Dx.displayName;let j=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(p.dk,{ref:t,className:(0,g.cn)("text-sm opacity-90",r),...n})});function A(){let{toasts:e}=function(){let[e,t]=n.useState(l);return n.useEffect(()=>(u.push(t),()=>{let e=u.indexOf(t);e>-1&&u.splice(e,1)}),[e]),{...e,toast:f,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}();return(0,a.jsxs)(h,{children:[e.map(function(e){let{id:t,title:r,description:n,action:s,...i}=e;return(0,a.jsxs)(b,{...i,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[r&&(0,a.jsx)(T,{children:r}),n&&(0,a.jsx)(j,{children:n})]}),s,(0,a.jsx)(w,{})]},t)}),(0,a.jsx)(v,{})]})}j.displayName=p.dk.displayName},3644:function(e,t,r){"use strict";r.r(t),r.d(t,{AppProvider:function(){return c},useApp:function(){return u}});var a=r(7437),n=r(2265),s=r(3015),i=r(4430);let o=(0,n.createContext)(void 0);function c(e){let{children:t}=e,{principal:r,isAuthenticated:c}=(0,s.useAuthContext)(),[u,l]=(0,n.useState)([]),[d,f]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[m,g]=(0,n.useState)(null),[h,v]=(0,n.useState)(!0),y=async()=>{try{let e=await i.t.getActor(),t=await e.getActiveListings();"ok"in t&&l(t.ok)}catch(e){console.error("Failed to fetch listings:",e)}},b=async()=>{if(r)try{let e=await i.t.getActor(),[t,a,n]=await Promise.all([e.getListingsByUser(r),e.getUserPurchases(),e.getStats()]);"ok"in t&&f(t.ok),"ok"in a&&x(a.ok),"ok"in n&&g(n.ok)}catch(e){console.error("Failed to fetch user data:",e)}};return(0,n.useEffect)(()=>{let e=async()=>{v(!0);try{await Promise.all([y(),b()])}finally{v(!1)}};c&&r?e():v(!1)},[c,r]),(0,a.jsx)(o.Provider,{value:{listings:u,userListings:d,transactions:p,userStats:m,isLoading:h,refreshListings:y,refreshUserData:b},children:t})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useApp must be used within an AppProvider");return e}},3015:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return o},useAuthContext:function(){return c}});var a=r(7437),n=r(2265),s=r(7262);let i=(0,n.createContext)(void 0);function o(e){let{children:t}=e,r=(0,s.a)();return(0,a.jsx)(i.Provider,{value:r,children:t})}function c(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},7262:function(e,t,r){"use strict";r.d(t,{a:function(){return s}});var a=r(2265),n=r(1928);function s(){let[e,t]=(0,a.useState)(!1),[r,s]=(0,a.useState)(null),[i,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await n.LY.create(),r=await e.isAuthenticated();if(t(r),r){let t=e.getIdentity();s(t.getPrincipal())}}catch(e){console.error("Auth initialization failed:",e)}finally{o(!1)}},u=async()=>{let e=await n.LY.create(),r=BigInt(1),a=BigInt(24),i=BigInt(36e11);e.login({identityProvider:"http://bkyz2-fmaaa-aaaaa-qaaaq-cai.localhost:8000",maxTimeToLive:r*a*i,onSuccess:()=>{t(!0);let r=e.getIdentity();s(r.getPrincipal())}})},l=async()=>{let e=await n.LY.create();await e.logout(),t(!1),s(null)};return{isAuthenticated:e,principal:(null==r?void 0:r.toString())||null,isLoading:i,login:u,logout:l}}},4430:function(e,t,r){"use strict";r.d(t,{t:function(){return i}});var a=r(1794),n=r(1928);let s=e=>{let{IDL:t}=e,r=t.Vec(t.Nat8),a=t.Record({e8s:t.Nat64}),n=t.Nat64,s=t.Vec(t.Nat8),i=t.Record({timestamp_nanos:t.Nat64});t.Record({to:r,fee:a,memo:n,from_subaccount:t.Opt(s),created_at_time:t.Opt(i),amount:a});let o=t.Nat64,c=t.Record({duration_nanos:t.Nat64}),u=t.Variant({TxTooOld:t.Record({allowed_window_nanos:c}),BadFee:t.Record({expected_fee:a}),TxDuplicate:t.Record({duplicate_of:o}),TxCreatedInFuture:t.Null,InsufficientFunds:t.Record({balance:a})});t.Variant({Ok:o,Err:u});let l=t.Variant({ok:t.Text,err:t.Text}),d=t.Variant({Sold:t.Null,Active:t.Null,Cancelled:t.Null,Expired:t.Null}),f=t.Record({id:t.Text,status:d,title:t.Text,expiresAt:t.Int,createdAt:t.Int,description:t.Text,seller:t.Principal,price:t.Nat64,images:t.Vec(t.Text)}),p=t.Variant({Failed:t.Null,Refunded:t.Null,Completed:t.Null,Pending:t.Null}),x=t.Record({id:t.Text,status:p,listingId:t.Text,createdAt:t.Int,buyer:t.Principal,price:t.Nat64}),m=t.Record({totalVolume:t.Nat64,totalListings:t.Nat,completedPurchases:t.Nat,activePurchases:t.Nat}),g=t.Variant({ok:t.Null,err:t.Text}),h=t.Service({createListing:t.Func([t.Text,t.Text,t.Nat64,t.Vec(t.Text),t.Int],[l],[]),createPurchase:t.Func([t.Text],[l],[]),getActiveListings:t.Func([],[t.Vec(f)],["query"]),getExpiredListings:t.Func([],[t.Vec(f)],["query"]),getListing:t.Func([t.Text],[t.Opt(f)],["query"]),getListings:t.Func([t.Opt(d),t.Opt(t.Nat64)],[t.Vec(f)],["query"]),getListingsByUser:t.Func([t.Principal],[t.Vec(f)],["query"]),getPurchase:t.Func([t.Text],[t.Opt(x)],["query"]),getStats:t.Func([],[m],["query"]),updateListing:t.Func([t.Text,t.Opt(t.Text),t.Opt(t.Text),t.Opt(t.Nat64),t.Opt(d)],[g],[])});return h},i=new class{async getActor(){if(this.actor)return this.actor;try{let e=await n.LY.create(),t=e.getIdentity(),r=new a.i7({identity:t,host:"http://localhost:8000"});return this.actor=a.vt.createActor(s,{agent:r,canisterId:"be2us-64aaa-aaaaa-qaabq-cai"}),this.actor}catch(e){throw console.error("Failed to create actor:",e),e}}constructor(){this.actor=null}}},9311:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(7042),n=r(4769);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},8877:function(){}},function(e){e.O(0,[395,258,769,941,971,864,744],function(){return e(e.s=8876)}),_N_E=e.O()}]);